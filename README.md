# FileNameChanger　nakoso

nanishiと違い、ウィンドウで操作をします。

## summary

PDFファイル内の文字列などに応じて、ファイル名を変更します。

ファイル名の命名方法は、事前にCSVファイルに設定します。

## operation

「設定ファイル」を「開く」ボタンをクリックして選択します。

「PDFファイル」を「開く」ボタンをクリックして選択するか、「ＰＤＦテキストエリア」にファイルをドラッグします。

「変更ファイル」名が想定通りならば、「変更」ボタンをクリックすると、ファイル名を変更します。

## install

必要なファイル

nakoso.jar

config.csv  設定ファイルのサンプルです

## configuration file

設定ファイル名のデフォルトは`config.csv`ですが、ファイル名は変えられます。
`nanishi`と共通です。

## 設定ファイルの内容

0, filename, 【変更ファイル名フォーマット】

【マッチ番号】, 【マッチ名称】, 【マッチパターン】, 【変換文字列フォーマット】
変更ファイル名フォーマット
マッチ番号、マッチ名称

マッチ番号は1～9です。

マッチ名称は、自由に記載できます。マッチ番号ごとに分かりやすい内容を書くことをお勧めします。
マッチパターン

==説明未作成==
変換文字列フォーマット

==説明未作成==
設定ファイルの記載例

0,Version,0.1,,,,
0,Option,Rename,または、Copy,,,
0,FilenameFormat,%2$s_%3$s,,,,
Comment,コメントの行になります,,,,,
Comment,マッチ名称,変換文字列フォーマット,マッチパターン,,,補足説明
1,日時,m,,yyyy-MM-dd,,m-ファイル更新日時、c-ファイル作成日時、a-ファイル最終アクセス日時、p-現在日時
2,書類名,1_法人税申告書,法人税申告書,,,
2,書類名,お知らせ,確定申告等についてのお知らせ,,,
2,書類名,確定申告書,+,,,+はマッチパターンは変換文字列と同一
2,書類名,00_確定申告書,年分の所\s*得\s*税\s*及\s*び復興特別所得税,,,マッチパターンは正規表現が使える
2,書類名,9_納税額一覧表,納税額一覧表,,,
2,書類名,利用者識別番号通知,電子申告・納税等に係る利用者識別番号等の通知,,,
3,顧問先名,%1$s,氏名又は名称\s*(.*)\s
3,顧問先名,%1$s,備\h考\h欄\H(.*)\H,法人税の達人の納付税額一覧表
3,顧問先名,田中工業,+,,,
3,顧問先名,佐藤太郎,*,,,*は文字の間に空白等が入っている場合もマッチする
3,顧問先名,%1$s橋直美,(高|髙)(\s|　)*橋(\s|　)*直(\s|　)*美,,,%1$sには、高か髙が入る
4,連番,#,,1,,
5,金額,%1$s,((\d|\u002c)+)円,,,""",""は\u002cを使うと良い。ファイル名では,などは_に置き換える"
6,元ファイル名,f,,令和(0-9)+年,令和%1$s年,
7,ディレクトリ,d,,(\d{3}),%1$s,

変更するファイル名は、マッチ番号2の書類名とマッチ番号3の法人名・個人名を、_（ハイフン）でつなげたものになります。%2$はマッチ番号2を示します。

PDFファイルの中に、青色申告決算書の文字列がどこかにあれば、書類名を青色申告決算書とします。

仕訳日記帳の文字列がどこかにあれば、書類名を53_仕訳日記帳とします。変換文字列フォーマットは、マッチパターンと異なっていても良いです。

マッチパターンは正規表現を使います。

残(\s|　)*高(\s|　)*試(\s|　)*算(\s|　)*表の(\s|　)*は間に空白がいくつか入っていてもマッチします。

(斎|斉)藤(\s|　)*花子の(斎|斉)は斎と斉のいずれにもマッチします。

変換文字列フォーマットの%1$sは、マッチパターンの１番目の()に合致した文字列に置き換えます。

最後の行の%1$s橋直美ならば、高か髙に置き換えます。

JAVAの正規表現、formatメソッドの機能を理解すれば、より複雑な設定ができます。


